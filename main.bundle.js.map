{"version":3,"sources":["webpack:///./src/app/app.component.css","webpack:///./src/app/app.component.html","webpack:///crypto (ignored)","webpack:///stream (ignored)","webpack:///./src async","webpack:///fs (ignored)","webpack:///./src/main.ts","webpack:///./src/app/app.component.ts","webpack:///./src/app/app.module.ts","webpack:///./src/environments/environment.ts"],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.css\n// module id = 138\n// module chunks = 1","module.exports = \"<div class=\\\"container\\\">\\n\\n  <h1>Proyecto</h1>\\n  <h2>Exportar datos a una columna</h2>\\n  <p>Exporte los datos de un excel hasta una fila llena de asteriscos </p>\\n\\n  <label class=\\\"custom-file\\\">\\n    <input type=\\\"file\\\" id=\\\"file\\\" class=\\\"custom-file-input\\\" (change)=\\\"eventoCuandoCambieArchivo($event)\\\" multiple=\\\"false\\\">\\n    <span class=\\\"custom-file-control btn btn-info\\\" style=\\\"background-color:#32a1ff;color: white; \\\">Elegir archivos</span>\\n  </label>\\n  <br>\\n  <br>\\n  <h3 *ngIf=\\\"datosExcel.length!=0\\\"> Datos en el excel:</h3>\\n  <br>\\n  <table class=\\\"table table-striped sjs-table\\\">\\n    <tr *ngFor=\\\"let fila of datosExcel\\\">\\n      <td *ngFor=\\\"let valorColumna of fila\\\">\\n        {{valorColumna}}\\n      </td>\\n    </tr>\\n  </table>\\n\\n  <br>\\n\\n  <button class=\\\"btn btn-outline-primary\\\" (click)=\\\"export()\\\">Exportar los datos</button>\\n\\n</div>\\n\\n\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/app.component.html\n// module id = 143\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// crypto (ignored)\n// module id = 173\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// stream (ignored)\n// module id = 174\n// module chunks = 1","function webpackEmptyContext(req) {\n\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 72;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src async\n// module id = 72\n// module chunks = 1","/* (ignored) */\n\n\n//////////////////\n// WEBPACK FOOTER\n// fs (ignored)\n// module id = 73\n// module chunks = 1","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule);\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts","import {Component} from '@angular/core';\nimport * as XLSX from 'xlsx';\nimport {saveAs} from 'file-saver';\n\n\ntype ArregloDeArreglos = Array<Array<any>>;\n\n\nfunction s2ab(s: string): ArrayBuffer {\n  const buf = new ArrayBuffer(s.length);\n  const view = new Uint8Array(buf);\n  for (let i = 0; i !== s.length; ++i) {\n    view[i] = s.charCodeAt(i) & 0xFF;\n  }\n  ;\n  return buf;\n}\n\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent {\n  datosExcel: ArregloDeArreglos = [];\n  opcionesDeGuardado: XLSX.WritingOptions = {\n    bookType: 'xlsx',\n    type: 'binary'\n  };\n\n  nombreArchivo: string = \"Proyecto.xlsx\";\n\n\n  eventoCuandoCambieArchivo(evento: any) {\n    /* wire up file reader */\n    const archivo: DataTransfer = <DataTransfer>(evento.target);\n    if (archivo.files.length != 1) {\n      throw new Error(\"No se puede subir mas de un archivo, lo siento.\")\n    }\n    ;\n\n\n    const lectorDeArchivos = new FileReader();\n    lectorDeArchivos.onload = (eventoLectura: any) => {\n      /* read workbook */\n      const archivoFormatoBinario = eventoLectura.target.result;\n      const hojaExcel = XLSX.read(archivoFormatoBinario, {type: 'binary'});\n\n      /* grab first sheet */\n      const nombrePrimeraHojaExcel = hojaExcel.SheetNames[0];\n      const primeraHojaExcel = hojaExcel.Sheets[nombrePrimeraHojaExcel];\n\n      /* save data */\n      this.datosExcel = <ArregloDeArreglos> (XLSX.utils.sheet_to_json(primeraHojaExcel, {header: 1}));\n    };\n    lectorDeArchivos.readAsBinaryString(archivo.files[0]);\n  }\n\n  export(): void {\n    /* generate worksheet */\n\n    const hojaDeTrabajoNueva = XLSX.utils.aoa_to_sheet(this.datosExcel);\n\n    let nuevoArreglo = Object.keys(hojaDeTrabajoNueva);\n\n\n    let letras = [];\n\n    nuevoArreglo.forEach(\n      (valor)=> {\n\n\n        const valorSoloLetras = valor.match(/[A-z]/g);\n\n        const noEstaEnElArregloDeLetrasYNoEsref = letras.find(\n          (valorArreglo)=> {\n            const esIgualQueElArreglo = valorArreglo[0] == valorSoloLetras\n            const noEsref = valorArreglo[0] == 'r';\n            return ( esIgualQueElArreglo || noEsref )\n          })\n\n        if (!noEstaEnElArregloDeLetrasYNoEsref) {\n          letras.push(valorSoloLetras[0]);\n        } else {\n          // return false;\n        }\n      }\n    );\n    letras.pop()\n\n    let numeroMayor = 0;\n    nuevoArreglo.forEach(\n      (objeto: string)=> {\n        let valor: any = objeto\n        let letras = valor.match(/[A-z]+/g);\n        let numero = Number(valor.replace(letras, ''));\n        if (numero >= numeroMayor) {\n          numeroMayor = numero;\n        }\n      }\n    );\n    console.log('NumeroMayor', numeroMayor)\n\n    let columna = []\n\n\n    for (let i = 0; i < letras.length; i++) {\n      for (let j = 0; j < numeroMayor; j++) {\n        let celda = hojaDeTrabajoNueva[letras[i] + (j + 1).toString()]\n        if (celda.v != '*') {\n          columna.push(celda.v);\n        }\n      }\n    }\n\n    let datosFinales = []\n    console.log(this.datosExcel);\n    console.log(columna);\n    datosFinales.push(columna);\n    console.log('datosFinales',datosFinales);\n    let contador = 0;\n    let arreglo2 = []\n    columna.forEach(\n      (valor,indice)=>{\n\n        let arreglo = []\n        arreglo.push(valor)\n        arreglo2.push(arreglo);\n        // console.log(arreglo.push(valor));\n        // datosFinales[indice]=\n        contador++;\n      }\n    );\n\n    console.log(arreglo2);\n\n\n    const hojaDeTrabajoNuevaValoresUnaFila = XLSX.utils.aoa_to_sheet(arreglo2);\n\n    /* generate workbook and add the worksheet */\n    const excelNuevo = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(excelNuevo, hojaDeTrabajoNuevaValoresUnaFila, 'Datos en una Fila');\n\n    /* save to file */\n    const archivoExcelNuevoACrearse = XLSX.write(excelNuevo, this.opcionesDeGuardado);\n\n    saveAs(new Blob([s2ab(archivoExcelNuevoACrearse)]), this.nombreArchivo);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HttpModule } from '@angular/http';\n\nimport { AppComponent } from './app.component';\n\n@NgModule({\n  declarations: [\n    AppComponent\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/app.module.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/environments/environment.ts"],"sourceRoot":""}